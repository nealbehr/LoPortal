<div id="messageContainer"></div>
<div class="row top-bar">
    <div class="col-sm-4 col-lg-3">
        <lo-admin-panel-search lo-search-key="searchKey" lo-searching-string="searchingString"></lo-admin-panel-search>
    </div>
    <div class="paging col-sm-4 col-sm-offset-4 col-lg-offset-5">
        <lo-admin-panel-pagination lo-pagination="pagination"></lo-admin-panel-pagination>
    </div>
</div>
<div class="admin-table user-managment">
    <div class="table-holder">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th class="header" ng-click="col.sort()" ng-repeat="col in headParams" ng-class="{headerSortUp: col.isSortedUp(), headerSortDown: col.isSortedDown(), isSortable: col.isSortable}"><span ng-bind-html="col.title"></span></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="request in queue">
                    <td>
                        <div class="attention" ng-if="request.duplicates.length > 0">
                            <ul>
                                <li ng-repeat="duplicate in request.duplicates">Please note, this row is duplicate of row with Request ID: [[ duplicate.id ]]</li>
                            </ul>
                        </div>
                        [[ request.id ]]
                    </td>
                    <td>[[ request.user_id ]]</td>
                    <td>[[ request.address ]]</td>
                    <td>[[ request.mls_number ]]</td>
                    <td>
                        <div>[[ request.created_at|fromMysqlDate| date:"MMM d yyyy" ]]</div>
                        [[ request.created_at|fromMysqlDate| date:"HH:mm a" ]]
                    </td>
                    <td>[[ request.request_type|requestType ]]</td>
                    <td>[[ request.state|requestState ]]</td>
                    <td>
                        <div class="dropdown">
                            <button class="action" type="button" data-toggle="dropdown">action</button>
                            <ul class="dropdown-menu dropdown-menu-right">
                                <li><a href="#" class="change">Edit</a></li>
                                <li><a href="#" class="approve" data-toggle="modal" data-target="#approve-request2">Approve</a></li>
                                <li ng-if="request.state != states.stateDeclined"><a href="#" ng-click="decline(request)" class="delete" data-toggle="modal" >Decline</a></li>
                            </ul>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div class="modal fade" id="approve-request1" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">close</button>
                <h4 class="modal-title">Approve the request</h4>
            </div>
            <div class="modal-body">
                <textarea cols="30" rows="3" class="form-control">Reason</textarea>
                <div class="attach">
                    <p>Upload final marketing collateral:</p>
                    <div class="wrap">
                        <a href="#" class="upload">Attach the document</a>
                        <span>PDF format only</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default btn-lg">Approve</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="approve-request2" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">close</button>
                <h4 class="modal-title">Approve the request</h4>
            </div>
            <div class="modal-body">
                <textarea cols="30" rows="3" class="form-control">Reason</textarea>
                <div class="attach">
                    <p>Upload final marketing collateral:</p>
                    <div class="wrap">
                        <a href="#" class="download">Example Listing Flyer.pdf</a>
                        <div class="pull-right">
                            <a href="#" class="change">Change</a> |
                            <a href="#" class="remove">Remove</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default btn-lg">Approve</button>
            </div>
        </div>
    </div>
</div>